import pandas as pd
import os

def create_all_tables_excel(output_file="input/semua_tabel.xlsx"):
    os.makedirs(os.path.dirname(output_file), exist_ok=True)
    
    all_tables_data = {}
    
    # Tabel 4.1 - Noise Reduction Coefficient
    data_4_1 = [
        ["50:50", "3:4", "15", 0.362, 0.365, 0.362, 0.364, 0.362],
        ["50:50", "3:4", "20", 0.286, 0.290, 0.295, 0.287, 0.292],
        ["50:50", "3:4", "25", 0.306, 0.302, 0.309, 0.308, 0.310],
        ["50:50", "4:4", "15", 0.333, 0.331, 0.341, 0.340, 0.339],
        ["50:50", "4:4", "20", 0.276, 0.277, 0.284, 0.277, 0.274],
        ["50:50", "4:4", "25", 0.276, 0.282, 0.281, 0.280, 0.281],
        ["50:50", "5:4", "15", 0.303, 0.308, 0.305, 0.307, 0.308],
        ["50:50", "5:4", "20", 0.266, 0.273, 0.268, 0.272, 0.270],
        ["50:50", "5:4", "25", 0.247, 0.245, 0.247, 0.251, 0.245],
        ["70:30", "3:4", "15", 0.390, 0.392, 0.390, 0.392, 0.392],
        ["70:30", "3:4", "20", 0.320, 0.313, 0.310, 0.314, 0.311],
        ["70:30", "3:4", "25", 0.280, 0.294, 0.283, 0.284, 0.287],
        ["70:30", "4:4", "15", 0.380, 0.380, 0.385, 0.390, 0.384],
        ["70:30", "4:4", "20", 0.333, 0.333, 0.344, 0.339, 0.335],
        ["70:30", "4:4", "25", 0.318, 0.309, 0.320, 0.316, 0.323],
        ["70:30", "5:4", "15", 0.386, 0.395, 0.389, 0.390, 0.388],
        ["70:30", "5:4", "20", 0.347, 0.355, 0.351, 0.352, 0.352],
        ["70:30", "5:4", "25", 0.356, 0.359, 0.365, 0.359, 0.361],
        ["90:10", "3:4", "15", 0.383, 0.388, 0.384, 0.388, 0.391],
        ["90:10", "3:4", "20", 0.383, 0.379, 0.384, 0.385, 0.382],
        ["90:10", "3:4", "25", 0.355, 0.357, 0.354, 0.361, 0.365],
        ["90:10", "4:4", "15", 0.317, 0.319, 0.322, 0.319, 0.320],
        ["90:10", "4:4", "20", 0.291, 0.293, 0.296, 0.298, 0.285],
        ["90:10", "4:4", "25", 0.282, 0.286, 0.285, 0.291, 0.284],
        ["90:10", "5:4", "15", 0.250, 0.252, 0.248, 0.245, 0.248],
        ["90:10", "5:4", "20", 0.199, 0.204, 0.206, 0.197, 0.194],
        ["90:10", "5:4", "25", 0.210, 0.218, 0.216, 0.211, 0.215]
    ]
    all_tables_data["tabel_4.1"] = {
        "data": data_4_1,
        "columns": ["Komposisi", "Kompaksi", "Cavity (mm)", "NRC1", "NRC2", "NRC3", "NRC4", "NRC5"]
    }
    
    # Tabel 4.2 - Decibel Drop (struktur sama dengan 4.1)
    data_4_2 = [
        ["50:50", "3:4", "15", 3.91, 3.94, 3.90, 3.93, 3.90],
        ["50:50", "3:4", "20", 2.92, 2.98, 3.03, 2.94, 3.00],
        ["50:50", "3:4", "25", 3.17, 3.12, 3.21, 3.20, 3.22],
        ["50:50", "4:4", "15", 3.51, 3.49, 3.62, 3.61, 3.60],
        ["50:50", "4:4", "20", 2.80, 2.82, 2.90, 2.82, 2.78],
        ["50:50", "4:4", "25", 2.81, 2.88, 2.87, 2.86, 2.86],
        ["50:50", "5:4", "15", 3.14, 3.19, 3.16, 3.18, 3.20],
        ["50:50", "5:4", "20", 2.68, 2.76, 2.71, 2.76, 2.73],
        ["50:50", "5:4", "25", 2.46, 2.44, 2.46, 2.51, 2.45],
        ["70:30", "3:4", "15", 4.29, 4.32, 4.29, 4.32, 4.32],
        ["70:30", "3:4", "20", 3.35, 3.26, 3.23, 3.27, 3.24],
        ["70:30", "3:4", "25", 2.86, 3.02, 2.89, 2.90, 2.94],
        ["70:30", "4:4", "15", 4.15, 4.16, 4.22, 4.30, 4.21],
        ["70:30", "4:4", "20", 3.52, 3.51, 3.66, 3.60, 3.55],
        ["70:30", "4:4", "25", 3.33, 3.21, 3.35, 3.30, 3.39],
        ["70:30", "5:4", "15", 4.24, 4.36, 4.29, 4.30, 4.26],
        ["70:30", "5:4", "20", 3.70, 3.81, 3.76, 3.77, 3.77],
        ["70:30", "5:4", "25", 3.82, 3.86, 3.94, 3.87, 3.88],
        ["90:10", "3:4", "15", 4.19, 4.26, 4.21, 4.27, 4.31],
        ["90:10", "3:4", "20", 4.19, 4.14, 4.20, 4.22, 4.18],
        ["90:10", "3:4", "25", 3.81, 3.84, 3.80, 3.89, 3.94],
        ["90:10", "4:4", "15", 3.31, 3.34, 3.38, 3.34, 3.34],
        ["90:10", "4:4", "20", 2.98, 3.02, 3.05, 3.08, 2.92],
        ["90:10", "4:4", "25", 2.88, 2.92, 2.91, 2.99, 2.91],
        ["90:10", "5:4", "15", 2.50, 2.53, 2.48, 2.45, 2.48],
        ["90:10", "5:4", "20", 1.92, 1.98, 2.00, 1.91, 1.88],
        ["90:10", "5:4", "25", 2.04, 2.13, 2.11, 2.06, 2.10]
    ]
    all_tables_data["tabel_4.2"] = {
        "data": data_4_2,
        "columns": ["Komposisi", "Kompaksi", "Cavity (mm)", "Decibel Drop 1", "Decibel Drop 2", "Decibel Drop 3", "Decibel Drop 4", "Decibel Drop 5"]
    }
    
    # Tabel 4.3 - Hasil uji normalitas
    data_4_3 = [
        ["50:50", "3:4", "15", 0.30, 0.56, "Diterima", "Normal"],
        ["50:50", "3:4", "20", 0.19, 0.56, "Diterima", "Normal"],
        ["50:50", "3:4", "25", 0.36, 0.56, "Diterima", "Normal"],
        ["50:50", "4:4", "15", 0.25, 0.56, "Diterima", "Normal"],
        ["50:50", "4:4", "20", 0.38, 0.56, "Diterima", "Normal"],
        ["50:50", "4:4", "25", 0.17, 0.56, "Diterima", "Normal"],
        ["50:50", "5:4", "15", 0.15, 0.56, "Diterima", "Normal"],
        ["50:50", "5:4", "20", 0.15, 0.56, "Diterima", "Normal"],
        ["50:50", "5:4", "25", 0.31, 0.56, "Diterima", "Normal"],
        ["70:30", "3:4", "15", 0.26, 0.56, "Diterima", "Normal"],
        ["70:30", "3:4", "20", 0.31, 0.56, "Diterima", "Normal"],
        ["70:30", "3:4", "25", 0.25, 0.56, "Diterima", "Normal"],
        ["70:30", "4:4", "15", 0.56, 0.56, "Diterima", "Normal"],
        ["70:30", "4:4", "20", 0.25, 0.56, "Diterima", "Normal"],
        ["70:30", "4:4", "25", 0.16, 0.56, "Diterima", "Normal"],
        ["70:30", "5:4", "15", 0.21, 0.56, "Diterima", "Normal"],
        ["70:30", "5:4", "20", 0.17, 0.56, "Diterima", "Normal"],
        ["70:30", "5:4", "25", 0.16, 0.56, "Diterima", "Normal"],
        ["90:10", "3:4", "15", 0.23, 0.56, "Diterima", "Normal"],
        ["90:10", "3:4", "20", 0.16, 0.56, "Diterima", "Normal"],
        ["90:10", "3:4", "25", 0.21, 0.56, "Diterima", "Normal"],
        ["90:10", "4:4", "15", 0.26, 0.56, "Diterima", "Normal"],
        ["90:10", "4:4", "20", 0.15, 0.56, "Diterima", "Normal"],
        ["90:10", "4:4", "25", 0.29, 0.56, "Diterima", "Normal"],
        ["90:10", "5:4", "15", 0.23, 0.56, "Diterima", "Normal"],
        ["90:10", "5:4", "20", 0.24, 0.56, "Diterima", "Normal"],
        ["90:10", "5:4", "25", 0.19, 0.56, "Diterima", "Normal"]
    ]
    all_tables_data["tabel_4.3"] = {
        "data": data_4_3,
        "columns": ["Komposisi", "Kompaksi", "Cavity (mm)", "L Hitung", "L Tabel", "H₀", "Kesimpulan"]
    }
    
    # Tabel 4.4 - Homogenitas
    data_4_4 = [
        ["1", 26, 0.44924, 11.6802, -0.3475, -9.04],
        ["2", 26, 0.44153, 11.4798, -0.3550, -9.23],
        ["3", 26, 0.44383, 11.5397, -0.3528, -9.17],
        ["4", 26, 0.47114, 12.2496, -0.3269, -8.50],
        ["5", 26, 0.47173, 12.2650, -0.3263, -8.48],
        ["Total", 130, 2.27748, 59.2144, -1.7085, -44.4209]
    ]
    all_tables_data["tabel_4.4"] = {
        "data": data_4_4,
        "columns": ["Pengulangan", "db = (n-1)", "Varian (S²)", "db S²", "log S²", "db log S²"]
    }
    
    # Tabel 4.5 - Interaksi faktor komposisi dan kompaksi
    data_4_5 = [
        ["50:50", 50.37, 46.23, 41.83, 138.43],
        ["70:30", 52.49, 55.45, 59.62, 167.55],
        ["90:10", 61.45, 46.37, 32.57, 140.39],
        ["Total", 164.30, 148.04, 134.02, 446.37]
    ]
    all_tables_data["tabel_4.5"] = {
        "data": data_4_5,
        "columns": ["Komposisi", "3:4", "4:4", "5:4", "Total"]
    }
    
    # Tabel 4.6 - ANOVA
    data_4_6 = [
        ["Perlakuan", 26, 1475.90, 56.76519, "", "", ""],
        ["Komposisi", 2, 11.78, 5.88925, 2873.486, 3.080386863, "Signifikan"],
        ["Kompaksi", 2, 10.21, 5.103314, 2490.012, 3.080386863, "Signifikan"],
        ["Cavity", 2, 12.04, 6.021029, 2937.784, 3.080386863, "Signifikan"],
        ["Komposisi*Kompaksi", 4, 21.75, 5.436283, 2663.562, 2.455766817, "Signifikan"],
        ["Komposisi*Cavity", 4, 1.24, 0.310764, 153.8291, 2.455766817, "Signifikan"],
        ["Kompaksi*Cavity", 4, 0.41, 0.103743, 45.5692, 2.455766817, "Signifikan"],
        ["Seluruh Faktor", 8, 1.60, 0.199547, 93.24303, 2.025247482, "Signifikan"],
        ["Galat", 108, 0.22, 0.00205, "", "", ""],
        ["Total", 134, 59.25, "", "", "", ""]
    ]
    all_tables_data["tabel_4.6"] = {
        "data": data_4_6,
        "columns": ["Faktor", "df", "SS", "MS", "Fhit", "Ftab (α=0,05)", "Keterangan"]
    }
    
    # Tabel 4.7 - Rata-rata decibel drop faktor komposisi
    data_4_7 = [
        ["Rata-rata", 3.08, 3.72, 3.12]
    ]
    all_tables_data["tabel_4.7"] = {
        "data": data_4_7,
        "columns": ["", "50:50 (A1)", "70:30 (A2)", "90:10 (A3)"]
    }
    
    # Tabel 4.8 - LSR faktor komposisi
    data_4_8 = [
        ["rate", 2.804, 3.362],
        ["LSR", 0.073, 0.088]
    ]
    all_tables_data["tabel_4.8"] = {
        "data": data_4_8,
        "columns": ["Signifikan", "2", "3"]
    }
    
    # Tabel 4.9 - Selisih perlakuan faktor komposisi
    data_4_9 = [
        ["A1", "", "", ""],
        ["A3", 0.044, "", ""],
        ["A2", 0.647, 0.604, ""]
    ]
    all_tables_data["tabel_4.9"] = {
        "data": data_4_9,
        "columns": ["", "A1", "A3", "A2"]
    }
    
    # Tabel 4.10 - Rata-rata decibel drop faktor kompaksi
    data_4_10 = [
        ["Rata-rata", 3.65, 3.29, 2.98]
    ]
    all_tables_data["tabel_4.10"] = {
        "data": data_4_10,
        "columns": ["", "3:4 (B1)", "4:4 (B2)", "5:4 (B3)"]
    }
    
    # Tabel 4.11 - LSR faktor kompaksi
    data_4_11 = [
        ["rate", 2.804, 3.362],
        ["LSR", 0.073, 0.088]
    ]
    all_tables_data["tabel_4.11"] = {
        "data": data_4_11,
        "columns": ["Signifikan", "2", "3"]
    }
    
    # Tabel 4.12 - Selisih perlakuan faktor kompaksi
    data_4_12 = [
        ["B3", "", "", ""],
        ["B2", 0.214, "", ""],
        ["B1", 0.575, 0.531, ""]
    ]
    all_tables_data["tabel_4.12"] = {
        "data": data_4_12,
        "columns": ["", "B3", "B2", "B1"]
    }
    
    # Tabel 4.13 - Rata-rata decibel drop faktor cavity
    data_4_13 = [
        ["Rata-rata", 3.73, 3.14, 3.05]
    ]
    all_tables_data["tabel_4.13"] = {
        "data": data_4_13,
        "columns": ["", "15mm (C1)", "20mm (C2)", "25mm (C3)"]
    }
    
    # Tabel 4.14 - LSR faktor cavity
    data_4_14 = [
        ["rate", 2.804, 3.362],
        ["LSR", 0.073, 0.088]
    ]
    all_tables_data["tabel_4.14"] = {
        "data": data_4_14,
        "columns": ["Signifikan", "2", "3"]
    }
    
    # Tabel 4.15 - Selisih perlakuan faktor cavity
    data_4_15 = [
        ["C2", "", "", ""],
        ["C3", 0.062, "", ""],
        ["C1", 0.659, 0.616, ""]
    ]
    all_tables_data["tabel_4.15"] = {
        "data": data_4_15,
        "columns": ["", "C2", "C3", "C1"]
    }
    
    # Tabel 4.16 - Rata-rata decibel drop komposisi dan kompaksi
    data_4_16 = [
        ["50:50 (A1)", 3.36, 3.08, 2.79],
        ["70:30 (A2)", 3.50, 3.70, 3.97],
        ["90:10 (A3)", 4.10, 3.09, 2.17]
    ]
    all_tables_data["tabel_4.16"] = {
        "data": data_4_16,
        "columns": ["Komposisi", "3:4 (B1)", "4:4 (B2)", "5:4 (B3)"]
    }
    
    # Tabel 4.17 - LSR komposisi dan kompaksi
    data_4_17 = [
        ["rate", 2.804, 3.362, 3.674, 3.926, 4.106, 4.252, 4.375, 4.480],
        ["LSR", 0.042, 0.051, 0.055, 0.059, 0.062, 0.064, 0.066, 0.068]
    ]
    all_tables_data["tabel_4.17"] = {
        "data": data_4_17,
        "columns": ["Signifikan", "2", "3", "4", "5", "6", "7", "8", "9"]
    }
    
    # Tabel 4.18 - Selisih perlakuan faktor komposisi dan kompaksi
    data_4_18 = [
        ["A3B3", "", "", "", "", "", "", "", "", ""],
        ["A1B3", 0.617, "", "", "", "", "", "", "", ""],
        ["A1B2", 0.910, 0.293, "", "", "", "", "", "", ""],
        ["A3B2", 0.920, 0.302, 0.009, "", "", "", "", "", ""],
        ["A1B1", 1.186, 0.569, 0.276, 0.267, "", "", "", "", ""],
        ["A2B1", 1.328, 0.710, 0.417, 0.408, 0.141, "", "", "", ""],
        ["A2B2", 1.525, 0.908, 0.615, 0.605, 0.339, 0.197, "", "", ""],
        ["A2B3", 1.803, 1.186, 0.893, 0.883, 0.617, 0.475, 0.278, "", ""],
        ["A3B1", 1.925, 1.308, 1.015, 1.005, 0.739, 0.597, 0.400, 0.122, ""]
    ]
    all_tables_data["tabel_4.18"] = {
        "data": data_4_18,
        "columns": ["", "A3B3", "A1B3", "A1B2", "A3B2", "A1B1", "A2B1", "A2B2", "A2B3", "A3B1"]
    }
    
    # Tabel 4.19 - Rata-rata decibel drop komposisi dan cavity
    data_4_19 = [
        ["50:50 (A1)", 3.55, 2.84, 2.83],
        ["70:30 (A2)", 4.27, 3.53, 3.37],
        ["90:10 (A3)", 3.36, 3.04, 2.96]
    ]
    all_tables_data["tabel_4.19"] = {
        "data": data_4_19,
        "columns": ["Komposisi", "15mm (C1)", "20mm (C2)", "25mm (C3)"]
    }
    
    # Tabel 4.20 - LSR komposisi dan cavity
    data_4_20 = [
        ["rate", 2.804, 3.362, 3.674, 3.926, 4.106, 4.252, 4.375, 4.480],
        ["LSR", 0.042, 0.051, 0.055, 0.059, 0.062, 0.064, 0.066, 0.068]
    ]
    all_tables_data["tabel_4.20"] = {
        "data": data_4_20,
        "columns": ["Signifikan", "2", "3", "4", "5", "6", "7", "8", "9"]
    }
    
    # Tabel 4.21 - Selisih perlakuan faktor komposisi dan cavity
    data_4_21 = [
        ["A3C3", "", "", "", "", "", "", "", "", ""],
        ["A1C3", 0.130, "", "", "", "", "", "", "", ""],
        ["A1C2", 0.194, 0.064, "", "", "", "", "", "", ""],
        ["A3C2", 0.289, 0.159, 0.095, "", "", "", "", "", ""],
        ["A2C3", 0.414, 0.284, 0.220, 0.125, "", "", "", "", ""],
        ["A2C2", 0.573, 0.443, 0.379, 0.284, 0.159, "", "", "", ""],
        ["A3C1", 0.399, 0.269, 0.205, 0.110, 0.015, 0.174, "", "", ""],
        ["A1C1", 0.585, 0.455, 0.391, 0.296, 0.171, 0.012, 0.186, "", ""],
        ["A2C1", 1.310, 1.180, 1.116, 1.021, 0.896, 0.737, 0.911, 0.725, ""]
    ]
    all_tables_data["tabel_4.21"] = {
        "data": data_4_21,
        "columns": ["", "A3C3", "A1C3", "A1C2", "A3C2", "A2C3", "A2C2", "A3C1", "A1C1", "A2C1"]
    }
    
    # Tabel 4.22 - Rata-rata decibel drop kompaksi dan cavity
    data_4_22 = [
        ["3:4 (B1)", 4.11, 3.45, 3.38],
        ["4:4 (B2)", 3.66, 3.14, 3.07],
        ["5:4 (B3)", 3.42, 2.82, 2.69]
    ]
    all_tables_data["tabel_4.22"] = {
        "data": data_4_22,
        "columns": ["Kompaksi", "15mm (C1)", "20mm (C2)", "25mm (C3)"]
    }
    
    # Tabel 4.23 - LSR kompaksi dan cavity
    data_4_23 = [
        ["rate", 2.804, 3.362, 3.674, 3.926, 4.106, 4.252, 4.375, 4.480],
        ["LSR", 0.042, 0.051, 0.055, 0.059, 0.062, 0.064, 0.066, 0.068]
    ]
    all_tables_data["tabel_4.23"] = {
        "data": data_4_23,
        "columns": ["Signifikan", "2", "3", "4", "5", "6", "7", "8", "9"]
    }
    
    # Tabel 4.24 - Selisih perlakuan faktor kompaksi dan cavity
    data_4_24 = [
        ["B3C3", "", "", "", "", "", "", "", "", ""],
        ["B3C2", 0.130, "", "", "", "", "", "", "", ""],
        ["B2C3", 0.377, 0.247, "", "", "", "", "", "", ""],
        ["B2C2", 0.442, 0.312, 0.065, "", "", "", "", "", ""],
        ["B3C1", 0.723, 0.593, 0.346, 0.281, "", "", "", "", ""],
        ["B1C3", 0.690, 0.560, 0.313, 0.248, 0.033, "", "", "", ""],
        ["B2C1", 0.965, 0.835, 0.588, 0.523, 0.242, 0.275, "", "", ""],
        ["B1C2", 0.761, 0.631, 0.384, 0.319, 0.038, 0.071, 0.204, "", ""],
        ["B1C1", 1.422, 1.292, 1.045, 0.980, 0.699, 0.732, 0.457, 0.661, ""]
    ]
    all_tables_data["tabel_4.24"] = {
        "data": data_4_24,
        "columns": ["", "B3C3", "B3C2", "B2C3", "B2C2", "B3C1", "B1C3", "B2C1", "B1C2", "B1C1"]
    }
    
    # Tabel 4.25 - Rata-rata decibel drop komposisi kompaksi dan cavity
    data_4_25 = [
        ["50:50", "3:4", 3.92, 2.98, 3.18],
        ["50:50", "4:4", 3.57, 2.82, 2.86],
        ["50:50", "5:4", 3.17, 2.73, 2.46],
        ["70:30", "3:4", 4.31, 3.27, 2.92],
        ["70:30", "4:4", 4.21, 3.57, 3.32],
        ["70:30", "5:4", 4.29, 3.76, 3.87],
        ["90:10", "3:4", 4.25, 4.19, 3.86],
        ["90:10", "4:4", 3.34, 3.01, 2.92],
        ["90:10", "5:4", 2.49, 1.94, 2.09]
    ]
    all_tables_data["tabel_4.25"] = {
        "data": data_4_25,
        "columns": ["Komposisi", "Kompaksi", "15mm (C1)", "20mm (C2)", "25mm (C3)"]
    }
    
    # Menyimpan data ke Excel dengan pandas tanpa styling atau merge
    with pd.ExcelWriter(output_file, engine='openpyxl') as writer:
        for sheet_name, table_info in all_tables_data.items():
            # Buat DataFrame dari data dan kolom
            df = pd.DataFrame(table_info["data"], columns=table_info["columns"])
            # Simpan langsung ke Excel tanpa index dan tanpa formatting
            df.to_excel(writer, sheet_name=sheet_name, index=False)
    
    print(f"Semua tabel telah disimpan ke {output_file} tanpa merge cells dan tanpa judul")
    return True

if __name__ == "__main__":
    print("====== MEMULAI PEMBUATAN FILE EXCEL SEDERHANA ======")
    create_all_tables_excel()
    print("====== PROSES PEMBUATAN EXCEL SELESAI ======")
